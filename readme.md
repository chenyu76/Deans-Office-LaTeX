# Deans-Office-LaTeX (教务处风格文档模板)

为什么学校发的各种word模板总喜欢用一个大表格装着？

> 一个用于生成“中国高校教务处风格”文档的 LaTeX 模板。
> 满足那种全文都在一个大表格里、边框严丝合缝、首页有复杂表头但正文需要跨页的奇妙Word模板的LaTeX排版。



## 简介

在中国高校的毕业设计开题报告、实验报告或行政表格中，经常遇到一种强制性排版要求：全文档必须看起来像在一个巨大的封闭表格中

LaTeX传统的 `tabular` 无法跨页，`longtable` 不支持单元格内复杂的图文混排。

本项目的核心思路是做个假的表格：
1.  视觉欺骗：利用 `TikZ` 和 `atbegshi` 在每一页生成边框，然后再插入分隔线，使其看起来就像是一个表格。
2.  流式排版：正文区域本质上是普通的文本流，可以随意分段、插入公式、列表，不再受限于表格单元格。

## 编译

仅在XeLaTeX下编译测试通过。

```bash
xelatex main.tex
````

注意：页面布局发生更改时，需要第二次编译边框线才能显示在正确的位置。

## 核心命令说明

### 全局配置

在导言区修改以下参数，即可改变整个文档的几何结构：

```latex
\setlength{\PageMargin}{1in}  % 边框距离纸张边缘的距离
\setlength{\RowHeight}{1.2em}   % 表格行的最小高度
\def\GlobalLineWidth{0.5pt}     % 外框粗细
```

### 生成表格行 (`\TableRow`)

类似 `tabularx` 的语法，但会自动画好下划线并撑满版心：

```latex
% 语法: \TableRow[最小高度]{列格式}{内容...}
% X = 自动宽度, c = 居中, | = 竖线

\TableRow{ c | X | c | X }{ 
    \textbf{姓名} & 张三 & \textbf{学号} & 2023001 
}
```

###  编写长文本

对于需要跨页的大段文字，不需要放在命令里，直接写即可。结束后用 `\SepLine` 封口：

```latex
\TableRow{l}{\textbf{一、研究内容}} % 标题行

这里是正文...可以写很长...可以跨页...
\begin{itemize}
  \item 支持列表
  \item 支持公式 $E=mc^2$
\end{itemize}

\SepLine % 画一条横线结束这一块
```

## 原理

本模板使用了 `atbegshi` 宏包的钩子，在 PDF 构建阶段（Shipout）在页面层之上绘制 TikZ 图层。

  - 外框：根据 `current page` 节点和 `\PageMargin` 变量计算绝对坐标矩形。
  - 横线：`\SepLine` 命令绘制一条宽度等于 `\textwidth` 的线，并微调左右端点以覆盖外框线宽。
  - 表头：使用 `\fill[white]` 覆盖掉外框顶部的线条（所以其实外框还在那里，只是被遮住了），再在上面绘制标题，实现“开口”效果。

## License

MIT License.
你可以随意修改此模板用于你的毕业论文或作业。
